"use strict";angular.module("bulbs.slideshow.edit.page",[]).directive("slideshowEditPage",function(){return{restrict:"E",templateUrl:"bulbs-cms/slideshow-edit/slideshow-edit-page/slideshow-edit-page.html",scope:{page:"="}}}),angular.module("bulbs.slideshow.edit",["bulbs.slideshow.edit.page","cms.image"]).directive("slideshowEdit",[function(){return{restrict:"E",templateUrl:"bulbs-cms/slideshow-edit/slideshow-edit.html",scope:{article:"="},controller:["$scope","$window","$timeout","CmsImage",function(a,b,c,d){function e(a,b){for(var c=0;c<a.length;c++)a[c][b]=c}a.isEditing=!1,a.selectedPage=null,a.$watch("article",function(b,c){a.selectedPage&&(a.selectedPage=_.find(a.pages,function(b){return b.order==a.selectedPage.order}))}),a.selectPage=function(b){a.selectedPage=b,a.isEditing=!!b,a.isEditing&&c(function(){d.picturefill($(".slideshow-page")[0])})},a.onAddPage=function(){var b={name:"",body:"",order:a.article.slides.length};a.article.slides.push(b),e(a.article.slides,"order"),a.selectPage(b)},a.onDeletePage=function(b,c){var d=b.indexOf(c);d>=0&&(b.splice(d,1),e(b,"order"),a.selectedPage&&c.order==a.selectedPage.order&&a.selectPage(null))},a.onClonePage=function(b){a.onAddPage();var c=a.selectedPage;angular.copy(b,c),c.title="Clone "+c.title},a.onDeleteObject=function(a,b){var c=a.indexOf(b);c>=0&&(a.splice(c,1),e(a,"order"))},a.onMoveListObject=function(a,b,c){if(b>=0&&c>=0&&c<a.length){var d=a[b];a.splice(b,1),a.splice(c,0,d),e(a,"order")}},0===a.article.slides.length&&a.onAddPage(),e(a.article.slides,"order")}]}}]),angular.module("bulbs.slideshow",["bulbs.slideshow.edit","bulbs.slideshow.templates"]),angular.module("bulbs.slideshow.templates",[]).run(["$templateCache",function(a){a.put("bulbs-cms/slideshow-edit/slideshow-edit-page/slideshow-edit-page.html",'<div class=slideshow-page><div class="form-control form-group clearfix page-text"><onion-editor ng-model=page.name role=singleline formatting=bold,italic,strike placeholder="Name (optionally used for display in CMS)"></onion-editor></div><div class=row><div class=col-xs-12><div class=center-block><betty-editable image=page.image ratio=16x9 placeholder-text="Top Image" add-styles="fa fa-camera-retro add-image-box p-img"></betty-editable></div></div></div><div class=well><onion-editor ng-model=page.body role=multiline inline-objects="{% static \'cms/onion-inline-config.json\' %}" placeholder="Body (displays on site)"></onion-editor></div></div>'),a.put("bulbs-cms/slideshow-edit/slideshow-edit.html",'<div class="slideshow row"><div class=col-xs-4><div class="navbar row"><div class=navbar-brand>Pages</div><div class="navbar-form btn-group pull-right"><button class="btn btn-default btn-sm" ng-click=onAddPage()><span class="glyphicon glyphicon-plus"></span> Page</button></div></div><ul class=list-group><li class="list-group-item clearfix" ng-repeat="page in article.slides" ng-class="{active:selectedPage && selectedPage.order == page.order }" ng-click=selectPage(page)><div class="btn-group btn-group-vertical pull-right"><button class="btn btn-link btn-xs" ng-click="onDeletePage(article.slides, page)"><span class="glyphicon glyphicon-remove"></span></button> <button class="btn btn-link btn-xs" ng-click="onMoveListObject(article.slides, $index, $index - 1)" ng-disabled="$index == 0"><span class="glyphicon glyphicon-chevron-up"></span></button> <button class="btn btn-link btn-xs" ng-click="onMoveListObject(article.slides, $index, $index + 1)" ng-disabled=$last><span class="glyphicon glyphicon-chevron-down"></span></button></div><span ng-show=!!page.name ng-bind-html=page.name></span> <span ng-show=!page.name>Page {{ $index + 1}}</span></li></ul></div><div class=col-xs-8><div ng-show=!isEditing><h3><span class="fa fa-arrow-left"></span> Create or select a page</h3></div><div ng-show=isEditing><slideshow-edit-page pages=article.slides page=selectedPage select-page=selectPage(selectedPage)></slideshow-edit-page></div></div></div>')}]);